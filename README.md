# Extract-Trasnform-Load
ETL program in python
# -*- coding: utf-8 -*-
"""ETL.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xy8qt8bavIp0aP3wHwbJG0R0jbXVDmiy
"""

import re
import csv
import json
import xml.etree.ElementTree as ET

# Create an empty list to store the strings with missing quotes
missing_quotes_list = []

tree = ET.parse("user_data.xml")
root = tree.getroot()
csv_file = open('user_data_xml.csv', 'w')
csv_writer = csv.writer(csv_file)

list_head = []
list_head.append('firstName')
list_head.append('lastName')
list_head.append('age')
list_head.append('sex')
list_head.append('phone')
list_head.append('retired')
list_head.append('dependants')
list_head.append('marital_status')
list_head.append('salary')
list_head.append('pension')
list_head.append('company')
list_head.append('commute_distance')
list_head.append('address_postcode')

csv_writer.writerow(list_head)

# loop through the xml file and write the data to the csv file
for member in root.findall('member'):
    list_data = []
    list_data.append(member.find('firstName').text)
    list_data.append(member.find('lastName').text)
    list_data.append(member.find('age').text)
    list_data.append(member.find('sex').text)
    list_data.append(member.find('phone').text)
    list_data.append(member.find('retired').text)
    list_data.append(member.find('dependants').text)
    list_data.append(member.find('marital_status').text)
    list_data.append(member.find('salary').text)
    list_data.append(member.find('pension').text)
    list_data.append(member.find('company').text)
    list_data.append(member.find('commute_distance').text)
    list_data.append(member.find('address').find('postcode').text)

    list_data.append(first_name)
    list_data.append(last_name)
    list_data.append(age)
    list_data.append(sex)
    list_data.append(phone)
    list_data.append(retired)
    list_data.append(dependants)
    list_data.append(marital_status)
    list_data.append(salary)
    list_data.append(pension)
    list_data.append(company)
    list_data.append(commute_distance)
    list_data.append(address_postcode)

    csv_writer.writerow(list_data)

# Read the CSV file
with open('user_data.csv', 'r') as csv_file:
    csv_reader = csv.reader(csv_file)
    for row in csv_reader:
        # Find strings with missing quotes using regular expression ignore none strings and empty strings
        matches = re.findall(r'(?<!\\)"[^"]*(?<!\\)"', row[0])
      
        # Add the strings to the list
        missing_quotes_list.extend(matches)

# Read the TXT file
with open('user_data.txt', 'r') as txt_file:
    txt_data = txt_file.read()
    # Find strings with missing quotes using regular expression
    matches = re.findall(r'[^"\s][^\s]*[^"\s]', txt_data)
    # Add the strings to the list
    missing_quotes_list.extend(matches)

# Read the XML file
# Read the CSV file
with open('user_data_xml.csv', 'r') as csv_file:
    csv_reader = csv.reader(csv_file)
    for row in csv_reader:
        # Find strings with missing quotes using regular expression ignore none strings and empty strings
        matches = re.findall(r'(?<!\\)"[^"]*(?<!\\)"', row[0])

        # Add the strings to the list
        missing_quotes_list.extend(matches)

# Write the strings to an Excel file
with open('missing_quotes.csv', 'w') as csv_file:
    csv_writer = csv.writer(csv_file)
    for string in missing_quotes_list:
        csv_writer.writerow([string])

# Print the list of strings with missing quotes
print(missing_quotes_list)
